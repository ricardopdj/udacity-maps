(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{36:function(e,t,n){e.exports=n(70)},41:function(e,t,n){},45:function(e,t,n){},70:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n.n(o),r=n(30),i=n.n(r),s=(n(41),n(43),n(11)),c=n(12),l=n(14),u=n(13),p=n(15),m=(n(45),n(74)),f=n(75),d=n(76),h=window.google,g=function(e){function t(){var e,n;Object(s.a)(this,t);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(a)))).state={mapLoaded:!1},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"getGoogleMaps",value:function(){var e=this;return this.googleMapsPromise||(this.googleMapsPromise=new Promise(function(t){window.resolveGoogleMapsPromise=function(){t(h),delete window.resolveGoogleMapsPromise};var n=document.createElement("script");n.src="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyC0FRwnvyqQbxEaU8JOuCojITxhb3bxdCQ","&callback=resolveGoogleMapsPromise"),n.async=!0,n.defer=!0,n.onerror=function(){e.props.onError()},document.body.appendChild(n)})),this.googleMapsPromise}},{key:"componentWillMount",value:function(){this.getGoogleMaps()}},{key:"componentDidMount",value:function(){var e=this;this.getGoogleMaps().then(function(t){e.createMap()})}},{key:"createMap",value:function(){var e=new window.google.maps.Map(document.getElementById("map"),{zoom:15,center:{lat:-30.0331,lng:-51.23}});this.props.onCreate(e)}},{key:"render",value:function(){return a.a.createElement("div",{id:"map",className:"h-100",role:"application","aria-label":"Neighborhood Map"})}}]),t}(o.Component),v=n(31),w=n(71),E=n(77),b=n(72),y=n(73),k=function(e){return a.a.createElement("aside",{className:"py-2"},a.a.createElement("h1",null,"Porto Alegre Sights"),a.a.createElement(w.a,{className:"my-4"},a.a.createElement(v.Debounce,{time:"400",handler:"onChange"},a.a.createElement(E.a,{placeholder:"Filter locations","aria-label":"Type a venue name to filter",onChange:function(t){return n=t.target.value,void e.onSearch(n);var n}}))),a.a.createElement(b.a,null,e.venues.length>0&&e.venues.map(function(t,n){return a.a.createElement(y.a,{tag:"button",key:n,onClick:function(){return function(t){e.onGetInfo(t)}(t)}},t.name)})))},M="?client_id=".concat("PNOZ54G0GD1T1N4MKUX2CXIRA3BF34R3BAKVZPRHX40GBYLK","&client_secret=").concat("H0LKKTR4QAXQEL2V42D123TKQ31CZQE0LULYNLLNZEBIJTBS","&v=20180323&limit=").concat(10,"&ll=").concat("-30.0346471, -51.2176584","&section=").concat("sights"),x="".concat("https://api.foursquare.com/v2/venues/explore").concat(M),N=function(e){return fetch("https://api.foursquare.com/v2/venues/".concat(e,"/photos").concat(M)).then(function(e){return e.json()}).then(function(e){return e.response.photos.items[0]}).then(function(e){return"".concat(e.prefix,"cap200").concat(e.suffix)}).catch(function(e){return console.log("Erro ao consultar a api do Foursquare",e)})},A=n(33),C=n.n(A),I=function(e){function t(){var e,n;Object(s.a)(this,t);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(a)))).state={apiError:!1,mapsError:!1,venues:[],visibleVenues:[],map:null,infoWindow:null,bounds:null,markers:[]},n.setMap=function(e){n.setState({map:e,infoWindow:new window.google.maps.InfoWindow,bounds:new window.google.maps.LatLngBounds});var t=n.createMarkers(e);n.setState({markers:t})},n.createMarkers=function(e){return n.state.venues.map(function(t){var o=new window.google.maps.Marker({position:t.location,map:e});return o.id=t.id,o.name=t.name,o.addListener("click",function(){return n.getInfo(t)}),n.fitBounds(o.position),o})},n.updateQuery=function(e){var t=new RegExp(C()(e),"i");n.setState({visibleVenues:n.state.venues.filter(function(e){return t.test(e.name)})}),n.state.infoWindow&&n.state.infoWindow.close(),n.state.markers.map(function(e){return e.setVisible(t.test(e.name))})},n.getInfo=function(e){e.photo?n.openInfo(e):N(e.id).then(function(t){return e.photo=t,e}).then(function(e){return n.openInfo(e)}).catch(function(e){return console.log("Erro ao consultar a api do Foursquare",e)})},n.openInfo=function(e){var t="<h4>".concat(e.name,"</h4><p>").concat(e.location.address,"</p>");e.photo&&(t="".concat(t,'<img src="').concat(e.photo,'" alt="').concat(e.name,'"/>')),n.state.infoWindow.setContent(t);var o=n.state.markers.find(function(t){return t.id===e.id});n.state.infoWindow.open(n.state.map,o),n.state.map.panTo(o.getPosition()),o.setAnimation(window.google.maps.Animation.DROP)},n.fitBounds=function(e){n.state.bounds.extend(e),n.state.map.fitBounds(n.state.bounds)},n.onMapError=function(){n.setState({mapsError:!0})},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch(x).then(function(e){return e.json()}).then(function(e){return e.response.groups[0].items}).then(function(e){return e.map(function(e){return e.venue})}).catch(function(e){throw e}).then(function(t){e.setState({venues:t,visibleVenues:t})}).catch(function(){e.setState({apiError:!0})})}},{key:"render",value:function(){return a.a.createElement(m.a,{fluid:!0,className:"h-100"},this.state.venues.length>0&&a.a.createElement(f.a,null,a.a.createElement(d.a,{xs:"12",lg:"4"},a.a.createElement(k,{venues:this.state.visibleVenues,onSearch:this.updateQuery,onGetInfo:this.getInfo})),a.a.createElement(d.a,{xs:"12",lg:"8"},!this.state.mapsError&&a.a.createElement(g,{onCreate:this.setMap,onError:this.onMapError,venues:this.state.visibleVenues}))),this.state.venues.length>0&&a.a.createElement(f.a,null,a.a.createElement(d.a,{xs:"12"},a.a.createElement("div",{className:"text-center py-3"},"Made with ",a.a.createElement("a",{href:"https://developer.foursquare.com"},"Foursquare API")," and ",a.a.createElement("a",{href:"https://cloud.google.com/maps-platform"},"Google Maps API")))),!this.state.venues.length&&!this.state.apiError&&a.a.createElement(f.a,{className:"h-100 align-items-center"},a.a.createElement(d.a,{xs:"12"},a.a.createElement("div",{className:"text-center py-3"},a.a.createElement("span",{className:"align-middle"},"Loading some Porto Alegre sights! Wait...")))),this.state.apiError&&a.a.createElement(f.a,{className:"h-100 align-items-center"},a.a.createElement(d.a,{xs:"12"},a.a.createElement("div",{className:"text-center py-3"},a.a.createElement("span",{className:"align-middle"},"Sorry! Something wrong happen, please try later :(")))))}}]),t}(o.Component),P=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function j(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.a.render(a.a.createElement(I,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/udacity-maps",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/udacity-maps","/service-worker.js");P?(function(e,t){fetch(e).then(function(n){var o=n.headers.get("content-type");404===n.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):j(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):j(t,e)})}}()}},[[36,2,1]]]);
//# sourceMappingURL=main.47aa9296.chunk.js.map